<?php$route = '/blog/';$app->get($route, function ()  use ($app){	$ReturnObject = array();	if(isset($_REQUEST['query'])){ $query = $_REQUEST['query']; } else { $query = '';}				// Pull from MySQL	if($query=='')		{		$Query = "SELECT * FROM blog WHERE name LIKE '%" . $query . "%'";		}	else {
		$Query = "SELECT * FROM blog";		
	}	$Query .= " ORDER BY name ASC";	//echo $Query . "<br />";		$DatabaseResult = mysql_query($Query) or die('Query failed: ' . mysql_error());	  	while ($Database = mysql_fetch_assoc($DatabaseResult))		{		$name = $Database['name'];		$url = $Database['url'];		$description = $Database['description'];		$tags = $Database['tags'];		$slug = $Database['slug'];						// manipulation zone				$F = array();		$F['name'] = $name;		$F['description'] = $description;		$F['url'] = $url;		$F['tags'] = $tags;		$F['slug'] = $slug;				array_push($ReturnObject, $F);		}		$app->response()->header("Content-Type", "application/json");		echo stripslashes(format_json(json_encode($ReturnObject)));	});$route = '/blog/:slug/';$app->get($route, function ($slug)  use ($app){	$ReturnObject = array();			$Query = "SELECT * FROM blog WHERE slug = '" . $slug . "'";	$Query .= " ORDER BY name ASC";	//echo $Query . "<br />";		$DatabaseResult = mysql_query($Query) or die('Query failed: ' . mysql_error());	  	while ($Database = mysql_fetch_assoc($DatabaseResult))		{		$name = $Database['name'];		$description = $Database['description'];		$url = $Database['url'];		$tags = $Database['tags'];			$slug = $Database['slug'];					// manipulation zone				$F = array();		$F['name'] = $name;		$F['description'] = $description;		$F['url'] = $url;		$F['tags'] = $tags;		$F['slug'] = $slug;				array_push($ReturnObject, $F);		}		$app->response()->header("Content-Type", "application/json");		echo stripslashes(format_json(json_encode($ReturnObject)));	});	$route = '/blog/';	$app->post($route, function () use ($app){		$Add = 1;	$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();			if(isset($_POST['name'])){ $name = $_POST['name']; } elseif(isset($_POST['name'])){ $name = $_REQUEST['name']; } else { $name = ''; }	if(isset($_POST['description'])){ $description = $_POST['description']; } elseif(isset($_POST['description'])){ $description = $_REQUEST['description']; } else { $description = ''; }	if(isset($_POST['url'])){ $url = $_POST['url']; } elseif(isset($_POST['url'])){ $url = $_REQUEST['url']; } else { $url = ''; }	if(isset($_POST['tags'])){ $tags = $_POST['tags']; } elseif(isset($_POST['tags'])){ $tags = $_REQUEST['tags']; } else { $tags = ''; }	if(isset($_POST['slug'])){ $slug = $_POST['slug']; } elseif(isset($_POST['slug'])){ $slug = $_REQUEST['slug']; } else { $slug = ''; }		  	$Query = "SELECT * FROM blog WHERE name = '" . $name . "'";	//echo $Query . "<br />";	$Database = mysql_query($Query) or die('Query failed: ' . mysql_error());		if($Database && mysql_num_rows($Database))		{			$ThisBlog = mysql_fetch_assoc($Database);			$Query .= ' - ' . $ThisBlog['slug'];		}	else 		{		$Query = "INSERT INTO blog(name,description,url,tags,slug) VALUES('" . mysql_real_escape_string($name) . "','" . mysql_real_escape_string($description) . "','" . mysql_real_escape_string($url) . "','" . mysql_real_escape_string($tags) . "','" . mysql_real_escape_string($slug) . "')";		//echo $query . "<br />";		mysql_query($Query) or die('Query failed: ' . mysql_error());					}	$F = array();	$F['name'] = $name;	$F['url'] = $url;	$F['tags'] = $tags;	$F['slug'] = $slug;		array_push($ReturnObject, $F);			$app->response()->header("Content-Type", "application/json");	echo stripslashes(format_json(json_encode($ReturnObject)));	});	$route = '/blog/:slug/';	$app->put($route, function ($slug) use ($app){			$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();			if(isset($_POST['name'])){ $name = $_POST['name']; } elseif(isset($_POST['name'])){ $name = $_REQUEST['name']; } else { $name = ''; }	if(isset($_POST['description'])){ $description = $_POST['description']; } elseif(isset($_POST['description'])){ $description = $_REQUEST['description']; } else { $description = ''; }	if(isset($_POST['url'])){ $url = $_POST['url']; } elseif(isset($_POST['url'])){ $url = $_REQUEST['url']; } else { $url = ''; }	if(isset($_POST['tags'])){ $tags = $_POST['tags']; } elseif(isset($_POST['tags'])){ $tags = $_REQUEST['tags']; } else { $tags = ''; }	  	$Query = "SELECT * FROM blog WHERE slug = '" . $slug . "'";	//echo $Query . "<br />";	$Database = mysql_query($Query) or die('Query failed: ' . mysql_error());		if($Database && mysql_num_rows($Database))		{			$query = "UPDATE blog SET";		$query .= " name = '" . mysql_real_escape_string($name) . "'";				if($description!='') { $query .= ", description = '" . mysql_real_escape_string($description) . "'"; }		if($description!='') { $query .= ", url = '" . mysql_real_escape_string($url) . "'"; }		if($description!='') { $query .= ", tags = '" . mysql_real_escape_string($tags) . "'"; }				$query .= " WHERE slug = '" . $slug . "'";				//echo $query . "<br />";		mysql_query($query) or die('Query failed: ' . mysql_error());			}	$F = array();	$F['name'] = $name;	$F['url'] = $url;	$F['tags'] = $tags;	$F['slug'] = $slug;		array_push($ReturnObject, $F);			$app->response()->header("Content-Type", "application/json");	echo stripslashes(format_json(json_encode($ReturnObject)));	});	$route = '/blog/:slug/';	$app->delete($route, function ($slug) use ($app){		$Add = 1;	$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();		$query = "DELETE FROM blog WHERE slug = '" . $slug . "'";	//echo $query . "<br />";	mysql_query($query) or die('Query failed: ' . mysql_error());		});				?>